(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{9329:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"q-pa-lg"},[n("MultipleBreadcrumbs",{attrs:{"multiple-data":e.multipleData}}),n("q-table",{attrs:{data:e.clientSessionList,columns:e.columns,"row-key":"id","visible-columns":e.visibleColumns,loading:e.changeLoading,filter:e.filter,"filter-method":e.onFilterData,pagination:e.pagination,"rows-per-page-label":e.$t("records_per_page")},on:{"row-click":e.onRowClick,request:e.onRequest,"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[n("h5",{staticClass:"q-my-none col-12",staticStyle:{"min-width":"150px"},attrs:{outlined:"",dense:"","options-dense":""}},[e._v("\n        "+e._s(e.$t("client.table_title"))+"\n      ")]),n("q-select",{staticClass:"q-pt-sm",staticStyle:{"min-width":"150px"},attrs:{multiple:"",outlined:"",dense:"","options-dense":"","display-value":e.$t("columns"),"emit-value":"","map-options":"",options:e.columns,"option-value":"name","options-cover":""},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}}),n("q-space")]},proxy:!0},{key:"body-cell-status",fn:function(t){return[n("q-td",{attrs:{props:t}},[n("TableStateField",{attrs:{field:t.row.status,stateInfo:e.state_info}})],1)]}},{key:"body-cell-expire_time",fn:function(t){return[n("q-td",{attrs:{props:t}},[e._v("\n        "+e._s(e.isOnline(t.row.status)?"-":t.row.expire_time)+"\n      ")])]}},{key:"body-cell-operation",fn:function(t){return[n("q-td",{directives:[{name:"show",rawName:"v-show",value:e.showDelete||e.showDetail,expression:"showDelete || showDetail"}],attrs:{props:t}},[n("div",[n("q-btn",{staticStyle:{"background-color":"#fff"},attrs:{flat:"",color:"black",icon:"more_vert",dense:""}},[n("q-menu",[n("q-list",{staticStyle:{"min-width":"100px"}},[n("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showDetail,expression:"showDetail"}],attrs:{clickable:"",to:{name:"client_detail",params:{client_id:t.row.client_id}}}},[n("q-item-section",[e._v(e._s(e.$t("detail")))])],1),n("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showDelete,expression:"showDelete"},{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:!e.isOnline(t.row.status)},on:{click:function(t){e.delModalControl=!e.delModalControl}}},[n("q-item-section",{class:{"text-grey-6":e.isOnline(t.row.status)}},[e._v(e._s(e.$t("delete")))]),e.isOnline(t.row.status)?n("q-tooltip",{attrs:{"content-class":"bg-primary"}},[e._v(e._s(e.$t("client.delete_hint")))]):e._e()],1)],1)],1)],1)],1)])]}}])},[n("TableNoData",{attrs:{slot:"no-data",filter:""},slot:"no-data"})],1),n("q-dialog",{attrs:{persistent:""},model:{value:e.delModalControl,callback:function(t){e.delModalControl=t},expression:"delModalControl"}},[n("q-card",[n("q-card-section",[n("div",{staticClass:"text-h6 text-weight-bold"},[e._v(e._s(e.$t("delete")))])]),n("q-card-section",{staticClass:"q-pt-none"},[n("span",{staticClass:"q-ml-sm"},[n("i18n",{attrs:{path:"client.reconfirm"}},[n("span",{staticStyle:{"font-weight":"bold"},attrs:{place:"client_id"}},[e._v(e._s(e.selectRow.client_id))])])],1)]),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("cancel"),color:"orange"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("delete"),color:"red"},on:{click:e.deleteClient}})],1)],1)],1)],1)},o=[],r=n("2f62"),a=n("73ec"),s=n("7ffc"),l=n("4d91"),c=function(){return c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c.apply(this,arguments)},u=function(e,t,n,i){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i["throw"](e))}catch(t){r(t)}}function l(e){e.done?n(e.value):o(e.value).then(a,s)}l((i=i.apply(e,t||[])).next())}))},d=function(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return l([e,t])}}function l(r){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,i&&(o=2&r[0]?i["return"]:r[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(o=a.trys,!(o=o.length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(s){r=[6,s],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},p={name:"ClientSessionPage",components:{},preFetch:function(e){var t=e.store;return u(this,void 0,void 0,(function(){var e;return d(this,(function(n){return e=[t.dispatch("getClientSessions",{})],t.state.acl.acl_user_list.length||e.push(t.dispatch("getAclUsers")),t.state.acl.acl_group_list.length||e.push(t.dispatch("getAclGroups")),Promise.race(e),[2]}))}))},setup:function(){var e=["client_id","ip","status","mountpoint","openfile_count","expire_time","version","root_dir","read_mode","map_rootuid","map_rootgid","map_useruid","map_usergid"];return(Object(a["b"])(s["a"].client_detail)||Object(a["b"])(s["a"].client_delete))&&e.push("operation"),{visibleColumns:e}},computed:c(c(c({},Object(r["e"])({clientSessionList:function(e){return e.report.client_session_list},aclUserList:function(e){return e.acl.acl_user_list},aclGroupList:function(e){return e.acl.acl_group_list}})),Object(r["c"])(["getClientSessionList"])),{showDetail:function(){return!0},showDelete:function(){return!0},columns:function(){var e=this,t=[{name:"client_id",label:this.$t("client.client_id"),field:"client_id",align:"left"},{name:"ip",label:this.$t("client.ip"),field:"ip",align:"left"},{name:"status",label:this.$t("client.status"),field:"status",align:"center"},{name:"mountpoint",label:this.$t("client.mountpoint"),field:"mountpoint",align:"center"},{name:"openfile_count",label:this.$t("client.openfile_count"),field:"openfile_count",align:"center",sortable:!0},{name:"expire_time",label:this.$t("client.expire_time"),field:"expire_time",align:"center"},{name:"version",label:this.$t("client.version"),field:"version",align:"center",sortable:!0},{name:"meta",label:this.$t("client.meta"),field:"meta",align:"center"},{name:"root_dir",label:this.$t("client.root_dir"),field:"root_dir",align:"center"},{name:"read_mode",label:this.$t("client.read_mode"),field:"rw",align:"center",format:function(e){return e?l["b"].t("read_write"):l["b"].t("read_only")}},{name:"map_rootuid",label:this.$t("client.map_rootuid"),field:"map_rootuid",align:"center",format:function(t){var n=e.get_user_field(e.aclUserList,t);return n?n+"("+t+")":t}},{name:"map_rootgid",label:this.$t("client.map_rootgid"),field:"map_rootgid",align:"center",format:function(t){var n=e.get_group_field(e.aclGroupList,t);return n?n+"("+t+")":t}},{name:"map_useruid",label:this.$t("client.map_useruid"),field:"map_useruid",align:"center",format:function(t){var n=e.get_user_field(e.aclUserList,t);return n?n+"("+t+")":t}},{name:"map_usergid",label:this.$t("client.map_usergid"),field:"map_usergid",align:"center",format:function(t){var n=e.get_group_field(e.aclGroupList,t);return n?n+"("+t+")":t}},{name:"operation",label:this.$t("operation"),field:"operation",align:"center"}];return t},multipleData:function(){var e=[{icon:"icon_dashboard",to:"/dashboard"},{label:this.$t("breadCrumbs.report"),icon:"icon_report",to:"/report/client",call:this.refreshList},{label:this.$t("breadCrumbs.client.page")}];return e},get_user_field:function(){return function(e,t){var n="";return e.map((function(e){+e.uid===+t&&(n=e.name)})),n}},get_group_field:function(){return function(e,t){var n="";return e.map((function(e){+e.gid===+t&&(n=e.name)})),n}},changeLoading:function(){return!(this.getClientSessionList.length>=0)},filter_columns:function(){return this.columns.filter((function(e){return"operation"!==e.name}))},reqs:function(){return this.columns.reduce((function(e,t){return t.required&&e.push(t.name),e}),[])},isOnline:function(){return function(e){return"online"===e}}}),data:function(){return{loading:!0,delModalControl:!1,selected:[],selectRow:[],byVisibility:!0,filter:"",filterCols:[],state_info:[{state:"online",color:"green",value:l["b"].tc("on",2),class:"bg-green-1 no-border-radius"},{state:"offline",color:"grey",value:l["b"].tc("off",2),class:"bg-grey-1 no-border-radius"}],pagination:{sortBy:"",descending:!1,page:1,rowsPerPage:20,rowsNumber:this.$store.state.report.client_total}}},methods:c(c(c({},Object(r["d"])(["SET_CLIENT_SESSIONS"])),Object(r["b"])(["getAclUsers","getAclGroups","getClientSessions","deleteClientSession"])),{onFilterData:function(e,t){return this.$refs.child.onFilter(e,t)},onRequest:function(e){return u(this,void 0,void 0,(function(){var t,n,i,o,r,a,s,l;return d(this,(function(c){switch(c.label){case 0:return t=e.pagination,n=t.page,i=t.rowsPerPage,o=t.sortBy,r=t.descending,a=i,0===i&&(a=100),s={offset:(n-1)*a,limit:a,sort_key:o,sort_oder:r?"desc":"asc"},[4,this.$store.dispatch("getClientSessions",s)];case 1:return c.sent(),this.pagination.page=n,this.pagination.rowsPerPage=i,this.pagination.sortBy=o,this.pagination.descending=r,this.filter&&(l=this.onFilterData(this.clientSessionList,this.filter),this.$store.commit("SET_CLIENT_SESSIONS",l),this.pagination.rowsNumber=l.length),[2]}}))}))},onRowClick:function(e,t,n){this.selectRow=t},refreshList:function(){return u(this,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return[4,this.$store.dispatch("getClientSessions",{})];case 1:return e.sent(),[2]}}))}))},addClient:function(){},onReset:function(){},deleteClient:function(){return u(this,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return[4,this.$store.dispatch("deleteClientSession",this.selectRow.client_id)];case 1:return e.sent(),[4,this.refreshList()];case 2:return e.sent(),[2]}}))}))}})},f=p,m=n("2877"),h=n("9989"),_=n("eaac"),g=n("ddd8"),b=n("2c91"),v=n("db86"),w=n("9c40"),y=n("4e73"),C=n("1c1c"),S=n("66e5"),$=n("4074"),q=n("05c0"),x=n("24e8"),k=n("f09f"),L=n("a370"),D=n("4b7e"),O=n("7f67"),Q=n("eebe"),N=n.n(Q),P=Object(m["a"])(f,i,o,!1,null,null,null);t["default"]=P.exports;N()(P,"components",{QPage:h["a"],QTable:_["a"],QSelect:g["a"],QSpace:b["a"],QTd:v["a"],QBtn:w["a"],QMenu:y["a"],QList:C["a"],QItem:S["a"],QItemSection:$["a"],QTooltip:q["a"],QDialog:x["a"],QCard:k["a"],QCardSection:L["a"],QCardActions:D["a"]}),N()(P,"directives",{ClosePopup:O["a"]})}}]);