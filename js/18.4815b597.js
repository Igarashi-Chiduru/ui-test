(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"56d7":function(e,t,o){},"703c":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("q-page",{staticClass:"q-pa-lg"},[o("q-card",[o("q-card-section",[o("h5",{staticClass:"q-my-none",staticStyle:{"min-width":"150px"},attrs:{outlined:"",dense:"","options-dense":""}},[e._v("\n        "+e._s(e.$t("terminal.process_title"))+"\n      ")])]),o("q-separator"),o("q-card-section",{staticClass:"row items-center justify-between q-py-none q-mt-md"},[o("q-item-label",{staticClass:"col-auto"},[o("div",{staticClass:"row items-center "},[o("q-select",{staticStyle:{"min-width":"150px","max-width":"300px"},attrs:{dense:"",outlined:"",label:e.$t("terminal.select_node"),options:e.nodeOptions,color:"primary","options-selected-class":"text-primary"},on:{input:e.selectNode},scopedSlots:e._u([{key:"option",fn:function(t){return[o("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[o("q-item-section",[o("q-item-label",{domProps:{innerHTML:e._s(t.opt.label)}}),o("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.opt.description))])],1)],1)]}}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)]),o("q-item-label",{staticClass:"col-auto"},[o("q-btn",{attrs:{color:"primary",label:e.$t("terminal.connect"),disable:null===e.model},on:{click:function(t){e.connectModel=!e.connectModel}}})],1)],1),o("q-card-section",[o("div",{ref:"xtermContainer",staticClass:"xtermContainer"})]),o("q-card-section",{staticClass:"row justify-between"},[o("div",{staticClass:"row col-sm-6 col-xs-12"},[o("q-select",{staticClass:"col-sm-4 col-xs-12",staticStyle:{"min-width":"150px","max-width":"300px"},attrs:{dense:"",outlined:"","options-dense":"",label:e.$t("terminal.select_color"),options:e.colorOptions},on:{input:e.changeColor},model:{value:e.themeColor,callback:function(t){e.themeColor=t},expression:"themeColor"}}),o("q-slider",{staticClass:"col-sm-4 col-xs-12 q-ml-lg",attrs:{min:12,max:24,step:1,label:"","label-value":"Size: "+e.fontSize,"label-always":"",color:"primary"},on:{input:e.changeSize},model:{value:e.fontSize,callback:function(t){e.fontSize=t},expression:"fontSize"}})],1),o("q-btn",{staticClass:" no-border-radius",attrs:{unelevated:"",label:e.$t("terminal.reset"),type:"submit",color:"primary"},on:{click:e.reset}})],1)],1),o("q-dialog",{model:{value:e.connectModel,callback:function(t){e.connectModel=t},expression:"connectModel"}},[o("q-card",[o("q-card-section",{staticClass:"row items-center"},[o("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("terminal.connect_title")))]),o("q-space"),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),o("q-form",{on:{submit:e.connectTerminal,reset:e.onReset}},[o("q-card-section",{staticClass:"row justify-center",staticStyle:{"min-width":"400px"}},[o("div",{staticClass:"col-sm-12 col-xs-11 q-gutter-md"},[o("q-input",{staticClass:"q-pb-sm",attrs:{label:e.$t("terminal.user"),outlined:"",dense:"",square:"",clearable:"",rules:[function(t){return t&&t.length>0||e.$t("terminal.user_hint")}]},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}}),o("q-input",{staticClass:"q-pb-sm",attrs:{label:e.$t("terminal.password"),outlined:"",dense:"",square:"",clearable:"",type:e.isPwd?"password":"text"},scopedSlots:e._u([{key:"append",fn:function(){return[o("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),o("div",{staticClass:"text-right"},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-sm no-border-radius",attrs:{outline:"",unelevated:"",label:e.$t("cancel"),type:"reset",color:"grey-6"}}),o("q-btn",{staticClass:"no-border-radius",attrs:{unelevated:"",label:e.$t("terminal.connect"),type:"submit",color:"primary",disable:""===e.form.user}})],1)],1)])],1)],1)],1)],1)},s=[],r=o("ded3"),i=o.n(r),a=o("c973"),c=o.n(a),l=(o("ac1f"),o("1276"),o("99af"),o("96cf"),o("2f62")),u=o("4d91"),d=o("2ef0"),m=o.n(d),p=o("fcf3"),b=o("173c"),f=o("47d0"),w=(o("abb2"),{name:"CmdPage",components:{},preFetch:function(e){return c()(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.store,t.next=3,o.dispatch("getNodeList");case 3:case"end":return t.stop()}}),t)})))()},setup:function(){return{}},mounted:function(){this.initTerm(),this.connectTerminal()},beforeDestroy:function(){this.terminal&&(this.terminal.dispose(),window.removeEventListener("resize",this.terminal.resizeScreen))},destroyed:function(){this.websock.close()},computed:i()(i()({},Object(l["e"])({nodeOptions:function(e){return e.nodes.node_ip_options}})),Object(l["c"])([])),data:function(){return{containerName:"",terminal:null,websock:null,terminalSocket:null,fontSize:14,themeColor:{label:u["b"].t("terminal.white"),value:{color:"white",background:"#060101"}},rows:36,colorOptions:[{label:u["b"].t("terminal.white"),value:{color:"white",background:"#060101"}},{label:u["b"].t("terminal.yellow"),value:{color:"yellow",background:"#060101"}},{label:u["b"].t("terminal.blue"),value:{color:"blue",background:"#ffebee"}},{label:u["b"].t("terminal.red"),value:{color:"red",background:"#e1f5fe"}},{label:u["b"].t("terminal.green"),value:{color:"green",background:"#f9fbe7"}},{label:u["b"].t("terminal.purple"),value:{color:"purple",background:"#ede7f6"}},{label:u["b"].t("terminal.grey"),value:{color:"grey",background:"#fff8e1"}},{label:u["b"].t("terminal.black"),value:{color:"black",background:"#fff"}}],model:null,form:{node_ip:m.a.split(this.$store.state.location_host,":")[0],user:"root",password:"user@dev"},connectModel:!1,isPwd:!0}},methods:i()(i()(i()({},Object(l["d"])([])),Object(l["b"])([])),{},{initTerm:function(){var e=new p["Terminal"]({fontSize:this.fontSize,cursorBlink:!0,disableStdin:!0,cursorStyle:"block",tabStopWidth:4,screenKeys:!0,rendererType:"canvas",rows:this.rows,convertEol:!1,theme:{foreground:this.foreground,background:"#060101",cursor:"help"}}),t=new f["FitAddon"];e.loadAddon(t),e.open(this.$refs.xtermContainer),t.fit(),e.focus(),e.resizeScreen=function(o){try{t.fit(),e.onResize((function(e){}))}catch(n){console.log("e",n.message)}},window.addEventListener("resize",e.resizeScreen),this.terminal=e,e.prompt=function(){e.write("UFS - Terminal\r\n\nPlease select the node you want to connect.\r\n$ ")},e.prompt(),e.onData((function(e){})),e.onLineFeed((function(e){})),e.onKey((function(e){}))},initWebSocket:function(e){var t=this;return c()(regeneratorRuntime.mark((function o(){var n,s,r,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n=e.node_ip,s=e.user,r=e.password,i="wss://".concat(t.$store.state.location_host,"/api/v1/terminal?node_ip=").concat(n,"&user=").concat(s,"&password=").concat(r),t.websock=new WebSocket(i),t.websock.onmessage=t.websocketonmessage,t.websock.onopen=t.websocketonopen,t.websock.onerror=t.websocketonerror,t.websock.onclose=t.websocketclose;case 7:case"end":return o.stop()}}),o)})))()},websocketonopen:function(e){console.log("websocket open")},websocketonerror:function(){console.log("websocket error"),this.onReset()},websocketonmessage:function(e){},websocketsend:function(e){this.websock.send(e)},websocketclose:function(e){console.log("websocket close",e)},selectNode:function(e){null!==this.websock&&(this.websock.close(),this.websocketclose()),this.model=e,this.form.node_ip=m.a.split(e.value,"|")[1]},changeSize:function(e){this.terminal.setOption("fontSize",e),this.terminal.resizeScreen()},changeColor:function(e){this.themeColor=e,this.terminal.setOption("theme",{foreground:e.value.color,background:e.value.background,cursor:"help"})},reset:function(){this.changeSize(14),this.fontSize=14,this.changeColor({label:u["b"].t("terminal.white"),value:{color:"white",background:"#060101"}})},connectTerminal:function(){var e=this;return c()(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return null!==e.websock&&(e.websock.close(),e.websocketclose()),t.next=3,e.initWebSocket(e.form);case 3:o=new b["AttachAddon"](e.websock),e.terminal.loadAddon(o),e.websock.onopen=function(){e.websock.send("htop --sort-key=%CPU --delay=30\n")},e.connectModel=!1,e.form={node_ip:"",user:"",password:""};case 8:case"end":return t.stop()}}),t)})))()},onReset:function(){this.model=null,this.form={node_ip:"",user:"",password:""}}})}),h=w,k=(o("a197"),o("2877")),v=o("9989"),g=o("f09f"),q=o("a370"),y=o("eb85"),C=o("0170"),S=o("ddd8"),x=o("66e5"),_=o("4074"),z=o("9c40"),$=o("c1d0"),Q=o("24e8"),P=o("2c91"),O=o("0378"),R=o("27f9"),T=o("0016"),j=o("7f67"),M=o("eebe"),L=o.n(M),N=Object(k["a"])(h,n,s,!1,null,"4d563f10",null);t["default"]=N.exports;L()(N,"components",{QPage:v["a"],QCard:g["a"],QCardSection:q["a"],QSeparator:y["a"],QItemLabel:C["a"],QSelect:S["a"],QItem:x["a"],QItemSection:_["a"],QBtn:z["a"],QSlider:$["a"],QDialog:Q["a"],QSpace:P["a"],QForm:O["a"],QInput:R["a"],QIcon:T["a"]}),L()(N,"directives",{ClosePopup:j["a"]})},a197:function(e,t,o){"use strict";o("56d7")}}]);