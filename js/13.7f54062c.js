(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{a4d3e:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"q-pa-lg"},[n("MultipleBreadcrumbs",{attrs:{"multiple-data":e.multipleData}}),n("q-table",{attrs:{data:e.nodeList,columns:e.columns,"row-key":"machine_id","visible-columns":e.visibleColumns,filter:e.filter,"filter-method":e.onFilterData,pagination:e.pagination,"rows-per-page-label":e.$t("records_per_page")},on:{"row-dblclick":e.rowDblClick,"row-click":e.onRowClick,request:e.onRequest,"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top",fn:function(){return[n("h5",{staticClass:"q-my-none col-12",staticStyle:{"min-width":"150px"},attrs:{outlined:"",dense:"","options-dense":""}},[e._v("\n        "+e._s(e.$t("node.table_title"))+"\n      ")]),n("q-select",{staticStyle:{"min-width":"150px"},attrs:{multiple:"",outlined:"",dense:"","options-dense":"","display-value":e.$t("columns"),"emit-value":"","map-options":"",options:e.columns,"option-value":"name","options-cover":""},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}}),n("q-space"),n("div",{staticClass:"q-pa-md "},[n("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.showAdd,expression:"showAdd"}],attrs:{label:e.$t("add"),color:"primary"},on:{click:function(t){e.addModalControl=!e.addModalControl}}})],1)]},proxy:!0},{key:"body-cell-id",fn:function(t){return[n("q-td",{attrs:{props:t}},[e._v("\n        "+e._s(t.pageIndex+1)+"\n      ")])]}},{key:"body-cell-state",fn:function(t){return[n("q-td",{attrs:{props:t}},[n("TableStateField",{attrs:{field:t.row.state,stateInfo:e.state_info}})],1)]}},{key:"body-cell-operation",fn:function(t){return[n("q-td",{attrs:{props:t}},[n("q-btn",{staticStyle:{"background-color":"#fff"},attrs:{flat:"",color:"black",icon:"more_vert",dense:""}},["damaged"!==t.row.state?n("q-menu",[n("q-list",{staticStyle:{"min-width":"100px"}},[n("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showDetail&&e.isOnline(t.row.state),expression:"showDetail && isOnline(props.row.state)"}],attrs:{clickable:""},on:{click:function(n){return e.nodeDetail(t.row)}}},[n("q-item-section",[e._v(e._s(e.$t("detail")))])],1),n("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showRemove,expression:"showRemove"}],attrs:{clickable:""},on:{click:function(t){return e.setModalControl("remove")}}},[n("q-item-section",[e._v(e._s(e.$t("remove")))])],1),n("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showPowerOff&&e.isOnline(t.row.state),expression:"showPowerOff && isOnline(props.row.state)"}],attrs:{clickable:""},on:{click:function(t){return e.setModalControl("poweroff")}}},[n("q-item-section",[e._v(e._s(e.$t("poweroff")))])],1),n("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showReboot&&e.isOnline(t.row.state),expression:"showReboot && isOnline(props.row.state)"}],attrs:{clickable:""},on:{click:function(t){return e.setModalControl("reboot")}}},[n("q-item-section",[e._v(e._s(e.$t("reboot")))])],1)],1)],1):e._e()],1)],1)]}}])},[n("TableNoData",{attrs:{slot:"no-data",filter:e.filter},slot:"no-data"})],1),n("q-dialog",{model:{value:e.addModalControl,callback:function(t){e.addModalControl=t},expression:"addModalControl"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center"},[n("div",{staticClass:"text-h6"},[e._v(e._s(e.$t("node.add_title")))]),n("q-space"),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),n("q-form",{on:{submit:e.onSubmit,reset:e.onReset}},[n("q-card-section",{staticClass:"row justify-center",staticStyle:{"min-width":"400px"}},[n("div",{staticClass:"col-sm-12 col-xs-11 q-gutter-md"},[n("q-input",{staticClass:"q-pb-sm",attrs:{label:e.$t("node.input_ip"),outlined:"",dense:"",square:"",clearable:"",disable:e.node_loading,"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.$t("node.input_ip_hint")},function(t){return e.isIPValid(t)||e.$t("node.input_ip_error_hint")}]},model:{value:e.form.ip,callback:function(t){e.$set(e.form,"ip",t)},expression:"form.ip"}}),n("div",{staticClass:"text-right"},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-sm no-border-radius",attrs:{outline:"",unelevated:"",label:e.$t("cancel"),type:"reset",color:"grey-6"}}),n("q-btn",{staticClass:"no-border-radius",style:e.node_loading?"width: 120px":"",attrs:{unelevated:"",label:e.$tc("submit",1),type:"submit",color:"primary",loading:e.node_loading},scopedSlots:e._u([{key:"loading",fn:function(){return[n("q-spinner-hourglass",{staticClass:"on-left"}),n("span",[e._v(e._s(e.$t("node.node_loading")))])]},proxy:!0}])})],1)],1)])],1)],1)],1),n("q-dialog",{attrs:{persistent:""},model:{value:e.operationModalControl,callback:function(t){e.operationModalControl=t},expression:"operationModalControl"}},[n("q-card",[n("q-card-section",[n("div",{staticClass:"text-h6 text-weight-bold"},[e._v("\n          "+e._s(e.operationDialog.title)+"\n        ")])]),n("q-card-section",{staticClass:"q-pt-none"},[n("span",{staticClass:"q-ml-sm"},[n("i18n",{attrs:{path:e.operationDialog.reconfirm}},[n("span",{staticStyle:{"font-weight":"bold"},attrs:{place:e.operationDialog.place}},[e._v(e._s(e.select_field))])])],1)]),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("cancel"),color:"orange"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.operationDialog.action,color:"red"},on:{click:e.nodeOperation}})],1)],1)],1)],1)},i=[],a=n("2f62"),r=n("73ec"),s=n("7ffc"),l=n("b6be"),c=n("4d91"),d=function(){return d=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},d.apply(this,arguments)},u=function(e,t,n,o){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,a){function r(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o["throw"](e))}catch(t){a(t)}}function l(e){e.done?n(e.value):i(e.value).then(r,s)}l((o=o.apply(e,t||[])).next())}))},f=function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return l([e,t])}}function l(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,o&&(i=2&a[0]?o["return"]:a[0]?o["throw"]||((i=o["return"])&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(s){a=[6,s],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},p={name:"nodePage",preFetch:function(e){var t=e.store;return u(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("getNodeList")];case 1:return e.sent(),[2]}}))}))},setup:function(){var e=["id","ip","hostname","distribution","state","current_time","release","boot_time"];return Object(r["b"])(s["a"].node_add||s["a"].node_detail||s["a"].node_remove||s["a"].node_action_poweroff||s["a"].node_action_reboot)&&e.push("operation"),{visibleColumns:e}},computed:d(d({},Object(a["e"])({nodeList:function(e){return e.nodes.node_list}})),{showAdd:function(){return!0},showDetail:function(){return!0},showRemove:function(){return!0},showPowerOff:function(){return!0},showReboot:function(){return!0},columns:function(){var e=[{name:"id",label:"#",field:"id",align:"left",style:"width: 2%"},{name:"machine_id",label:this.$t("node.machine_id"),field:"machine_id",align:"left"},{name:"ip",label:this.$t("node.ip"),field:"ip",align:"left"},{name:"state",label:this.$t("node.state"),field:"state",align:"center",sortable:!0},{name:"hostname",label:this.$t("node.hostname"),field:"hostname",align:"center"},{name:"release",label:this.$t("node.release"),field:"release",align:"center"},{name:"boot_time",label:this.$t("node.boot_time"),field:"boot_time",align:"center",sortable:!0},{name:"current_time",label:this.$t("node.run_time"),field:"current_time",align:"center",sortable:!0,format:function(e,t){var n=new Date(e).valueOf(),o=new Date(t.boot_time).valueOf(),i=(n-o)/1e3;if(i<=0)return"-";if(i<60)return i+" "+c["b"].t("second");var a=Object(r["e"])((n-o)/1e3);return e=(a.days?a.days:"")+" "+(a.days?c["b"].t("day"):"")+" "+(a.hours?a.hours:"")+" "+(a.hours?c["b"].t("hour"):"")+" "+(a.minutes?a.minutes:"")+" "+(a.minutes?c["b"].t("minute"):""),e}},{name:"operation",label:this.$t("operation"),field:"operation",align:"center"}];return e},multipleData:function(){var e=[{icon:"icon_dashboard",to:"/dashboard"},{label:this.$t("breadCrumbs.node_manager"),icon:"icon_node_manager",to:"/node_manager/nodes",call:this.refreshList},{label:this.$t("breadCrumbs.node.page")}];return e},filter_columns:function(){return this.columns.filter((function(e){return"operation"!==e.name&&"id"!==e.name}))},reqs:function(){return this.columns.reduce((function(e,t){return t.required&&e.push(t.name),e}),[])}}),data:function(){var e=this.$store.state.nodes.node_list.length;return{filter:"",online:"ONLINE",state_info:[{state:"ONLINE",color:"green",value:c["b"].tc("on",2),class:"bg-green-1 no-border-radius"},{state:"OFFLINE",color:"grey",value:c["b"].tc("off",2),class:"bg-grey-1 no-border-radius"}],addModalControl:!1,operationModalControl:!1,operationDialog:{title:"",reconfirm:"",place:"",action:""},select_field:"",form:{ip:""},selectRow:null,pagination:{page:1,rowsNumber:e},node_loading:!1}},methods:{onRowClick:function(e,t,n){this.selectRow=t},onFilterData:function(e,t){return this.$refs.child.onFilter(e,t)},onRequest:function(e){return u(this,void 0,void 0,(function(){var t,n,o,i,a,r,s;return f(this,(function(l){switch(l.label){case 0:return t=e.pagination,n=t.page,o=t.rowsPerPage,i=t.sortBy,a=t.descending,r=o,0===o&&(r=100),s={offset:(n-1)*r,limit:r,sort_key:i,sort_oder:a?"desc":"asc"},[4,this.$store.dispatch("getNodeList",s)];case 1:return l.sent(),this.pagination.page=n,this.pagination.rowsPerPage=o,this.pagination.sortBy=i,this.pagination.descending=a,[2]}}))}))},isIPValid:function(e){return Object(l["a"])(e)},isOnline:function(e){return e==this.online},bytes2human:function(e){return Object(r["a"])(e)},onSubmit:function(){return u(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return this.node_loading=!0,[4,this.$store.dispatch("addNode",{ip:this.form.ip})];case 1:return e.sent(),this.node_loading=!1,this.addModalControl=!1,this.form={ip:""},[4,this.$store.dispatch("getNodeList",{})];case 2:return e.sent(),[2]}}))}))},onReset:function(){this.form={ip:""}},refreshList:function(){return u(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this.$store.dispatch("getNodeList")];case 1:return e.sent(),[2]}}))}))},setModalControl:function(e){switch(this.operationModalControl=!0,this.action=e,this.select_field=this.selectRow.ip,e){case"remove":this.operationDialog={title:c["b"].t("remove"),reconfirm:"node.delete_reconfirm",place:"ip",action:c["b"].t("remove")};break;case"poweroff":this.operationDialog={title:c["b"].t("poweroff"),reconfirm:"node.poweroff_reconfirm",place:"ip",action:c["b"].t("poweroff")};break;case"reboot":this.operationDialog={title:c["b"].t("reboot"),reconfirm:"node.reboot_reconfirm",place:"ip",action:c["b"].t("reboot")};break}},nodeOperation:function(){return u(this,void 0,void 0,(function(){var e,t;return f(this,(function(n){switch(n.label){case 0:switch(e={machine_id:this.selectRow.machine_id},t=this.action,t){case"remove":return[3,1];case"poweroff":return[3,3];case"reboot":return[3,5]}return[3,7];case 1:return[4,this.$store.dispatch("removeNode",e.machine_id)];case 2:return n.sent(),[3,8];case 3:return[4,this.$store.dispatch("poweroffNode",e.machine_id)];case 4:return n.sent(),[3,8];case 5:return[4,this.$store.dispatch("rebootNode",e.machine_id)];case 6:return n.sent(),[3,8];case 7:return[3,8];case 8:return[4,this.refreshList()];case 9:return n.sent(),[2]}}))}))},nodeDetail:function(e){this.$router.push({name:"nodes/detail",params:{machine_id:e.machine_id}})},rowDblClick:function(e,t,n){this.isOnline(t.state)&&this.$router.push({name:"nodes/detail",params:{machine_id:t.machine_id}})}}},h=p,m=(n("fdd3"),n("2877")),b=n("9989"),w=n("eaac"),v=n("ddd8"),_=n("2c91"),g=n("9c40"),y=n("db86"),q=n("4e73"),C=n("1c1c"),$=n("66e5"),k=n("4074"),x=n("24e8"),F=n("f09f"),O=n("a370"),A=n("0378"),N=n("27f9"),D=n("9149"),M=n("4b7e"),S=n("7f67"),Q=n("eebe"),R=n.n(Q),P=Object(m["a"])(h,o,i,!1,null,null,null);t["default"]=P.exports;R()(P,"components",{QPage:b["a"],QTable:w["a"],QSelect:v["a"],QSpace:_["a"],QBtn:g["a"],QTd:y["a"],QMenu:q["a"],QList:C["a"],QItem:$["a"],QItemSection:k["a"],QDialog:x["a"],QCard:F["a"],QCardSection:O["a"],QForm:A["a"],QInput:N["a"],QSpinnerHourglass:D["a"],QCardActions:M["a"]}),R()(P,"directives",{ClosePopup:S["a"]})},b6be:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var o=function(e){var t=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;return t.test(e)},i=function(e){var t=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/gm;return t.test(e)},a=function(e){return i(e)||o(e)},r=function(e){var t=/^[_a-zA-Z0-9]+$/;return t.test(e)}},bf44:function(e,t,n){},fdd3:function(e,t,n){"use strict";n("bf44")}}]);