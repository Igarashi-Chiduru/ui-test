(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{"0829":function(e,t,a){"use strict";a("8ed5")},"896b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"q-pa-lg"},[a("MultipleBreadcrumbs",{attrs:{"multiple-data":e.multipleData}}),a("q-table",{attrs:{data:e.quotaList,columns:e.columns,"row-key":"path","visible-columns":e.visibleColumns,loading:e.changeLoading,filter:e.filter,"filter-method":e.onFilterData,"rows-per-page-label":e.$t("records_per_page")},scopedSlots:e._u([{key:"top",fn:function(){return[a("h5",{staticClass:"q-my-none col-12",staticStyle:{"min-width":"150px"},attrs:{outlined:"",dense:"","options-dense":""}},[e._v("\n        "+e._s(e.$t("quota.table_title"))+"\n      ")]),a("div",{staticClass:"q-pa-md row col-12 justify-end"},[a("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.showCreate,expression:"showCreate"}],attrs:{to:{name:"quota_set",params:{action:"add"}},label:e.$t("add"),color:"primary"}})],1)]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{key:"id",attrs:{props:t}},[e._v("\n          "+e._s(t.pageIndex+1)+"\n        ")]),a("q-td",{key:"path",attrs:{props:t}},[e._v("\n          "+e._s(t.row.path)+"\n        ")]),a("q-td",{key:"inodes",attrs:{props:t}},[a("q-list",{staticClass:"rounded-borders",attrs:{dense:"",padding:""}},e._l(t.row.inodes,(function(n,r,o){return a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.show_field(r),expression:"show_field(key)"}],key:o},[a("q-item-section",[e._v(" "+e._s(e.$t("quota."+r))+" : ")]),a("q-item-section",[a("span",[e._v(e._s(e.formatter_inode(n,r,t.row.inodes)))])])],1)})),1)],1),a("q-td",{key:"length",attrs:{props:t}},[a("q-list",{staticClass:"rounded-borders",attrs:{dense:"",padding:""}},e._l(t.row.length,(function(n,r,o){return a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.show_field(r),expression:"show_field(key)"}],key:o},[a("q-item-section",[e._v(" "+e._s(e.$t("quota."+r))+" : ")]),a("q-item-section",[a("span",[e._v(e._s(e.formatter_item(n,r,t.row.size)))])])],1)})),1)],1),a("q-td",{key:"realsize",attrs:{props:t}},[a("q-list",{staticClass:"rounded-borders",attrs:{dense:"",padding:""}},e._l(t.row.realsize,(function(n,r,o){return a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.show_field(r),expression:"show_field(key)"}],key:o,staticClass:"row justify-center"},[a("q-item-section",[e._v(" "+e._s(e.$t("quota."+r))+" : ")]),a("q-item-section",[a("span",[e._v(e._s(e.formatter_item(n,r,t.row.size)))])])],1)})),1)],1),a("q-td",{key:"size",attrs:{props:t}},[a("q-list",{staticClass:"rounded-borders",attrs:{dense:"",padding:""}},e._l(t.row.size,(function(n,r,o){return a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.show_field(r),expression:"show_field(key)"}],key:o},[a("q-item-section",[e._v(" "+e._s(e.$t("quota."+r))+" : ")]),a("q-item-section",[a("span",[e._v(e._s(e.formatter_item(n,r,t.row.size)))])])],1)})),1)],1),a("q-td",{key:"exceeded",attrs:{props:t}},[a("TableStateField",{attrs:{field:t.row.exceeded,stateInfo:e.exceeded_info}})],1),a("q-td",{key:"expired_time",attrs:{props:t}},[a("span",{style:"expired"===t.row.expired_time?"color: red":""},[e._v(e._s(0===t.row.expired_time?"-":t.row.expired_time))])]),a("q-td",{key:"grace_period",attrs:{props:t}},[e._v("\n          "+e._s(t.row.grace_period)+"\n        ")]),a("q-td",{directives:[{name:"show",rawName:"v-show",value:e.showDetail||e.showDelete||e.showUpdate,expression:"showDetail || showDelete || showUpdate"}],key:"operation",attrs:{align:"center"}},[a("div",[a("q-btn",{staticStyle:{"background-color":"#fff"},attrs:{flat:"",color:"black",icon:"more_vert",dense:""},on:{click:function(a){return e.onRowClick(t.row)}}},[a("q-menu",[a("q-list",{staticStyle:{"min-width":"100px"}},[a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showDetail,expression:"showDetail"}],attrs:{clickable:"",to:"/file_manager/smart_quota/detail"+t.row.path}},[a("q-item-section",[e._v(e._s(e.$t("detail")))])],1),a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showUpdate,expression:"showUpdate"},{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:"",to:{name:"quota_set",params:{action:"update"}}}},[a("q-item-section",[e._v(e._s(e.$t("update")))])],1),a("q-item",{directives:[{name:"show",rawName:"v-show",value:e.showDelete,expression:"showDelete"},{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.delModalControl=!e.delModalControl}}},[a("q-item-section",[e._v(e._s(e.$t("delete")))])],1)],1)],1)],1)],1)])],1)]}}])},[a("TableNoData",{attrs:{slot:"no-data",filter:""},slot:"no-data"})],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.delModalControl,callback:function(t){e.delModalControl=t},expression:"delModalControl"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6 text-weight-bold"},[e._v(e._s(e.$t("delete")))])]),a("q-card-section",{staticClass:"q-pt-none"},[a("span",{staticClass:"q-ml-sm"},[a("i18n",{attrs:{path:"quota.reconfirm"}},[a("span",{staticStyle:{"font-weight":"bold"},attrs:{place:"quota_path"}},[e._v(e._s(e.selectRow.path))])])],1)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("cancel"),color:"orange"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:e.$t("delete"),color:"red"},on:{click:e.deleteQuota}})],1)],1)],1)],1)},r=[],o=a("2f62"),s=a("73ec"),i=a("7ffc"),l=a("4d91"),c=function(){return c=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a],t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},c.apply(this,arguments)},u=function(e,t,a,n){function r(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function i(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?a(e.value):r(e.value).then(s,i)}l((n=n.apply(e,t||[])).next())}))},d=function(e,t){var a,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(e){return function(t){return l([e,t])}}function l(o){if(a)throw new TypeError("Generator is already executing.");while(s)try{if(a=1,n&&(r=2&o[0]?n["return"]:o[0]?n["throw"]||((r=n["return"])&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(i){o=[6,i],n=0}finally{a=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},p=function(e,t){for(var a=0,n=t.length,r=e.length;a<n;a++,r++)e[r]=t[a];return e},h={name:"quotaPage",components:{},preFetch:function(e){var t=e.store;return u(this,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return[4,t.dispatch("getQuotas",{})];case 1:return e.sent(),[2]}}))}))},setup:function(){var e=["id","path","inodes","length","realsize","size","exceeded","expired_time","grace_period"];return(Object(s["b"])(i["a"].quota_detail)||Object(s["b"])(i["a"].quota_create)||Object(s["b"])(i["a"].quota_delete)||Object(s["b"])(i["a"].quota_update))&&e.push("operation"),{visibleColumns:e}},data:function(){return{loading:!0,delModalControl:!1,selected:[],selectRow:[],byVisibility:!0,filter:"",filterCols:[],maxLength:3,fst_length:["soft_quota","hard_quota","current_values"],exceeded_info:[{state:0,color:"green",value:l["b"].t("quota.no_overrun"),class:"bg-green-1 no-border-radius"},{state:1,color:"amber",value:l["b"].t("quota.overrun"),class:"bg-amber-1 no-border-radius"}]}},computed:c(c(c({},Object(o["e"])({quotaList:function(e){return e.quotas.quota_list}})),Object(o["c"])({getquotaList:"getQuotaList"})),{isRunning:function(){var e=this;return function(t){return t===e.status}},showCreate:function(){return Object(s["b"])(i["a"].quota_create)},showDetail:function(){return Object(s["b"])(i["a"].quota_detail)},showUpdate:function(){return Object(s["b"])(i["a"].quota_update)},showDelete:function(){return Object(s["b"])(i["a"].quota_delete)},filter_columns:function(){return this.columns.filter((function(e){return"operation"!==e.name&&"inodes"!==e.name&&"length"!==e.name&&"realsize"!==e.name&&"size"!==e.name&&"id"!==e.name}))},show_field:function(){return function(e){return"hard_percent"!==e&&"soft_percent"!==e}},formatter_inode:function(){return function(e,t,a){var n=e;switch(t){case"hard_quota":n=null===e?"-":e+" / "+(null===a.hard_percent||null===a.hard_percent?0:a.hard_percent)+"%";break;case"soft_quota":n=null===e?"-":e+" / "+(null===a.soft_percent||null===a.hard_percent?0:a.hard_percent)+"%";break;case"current_value":n=e;break;default:break}return n}},formatter_item:function(){var e=this;return function(t,a,n){console.log(t,a,n);var r=t;switch(a){case"hard_quota":r=null===t?"-":e.bytes2human(t)+" / "+(null===n.hard_percent||null===n.hard_percent?0:n.hard_percent)+"%";break;case"soft_quota":r=null===t?"-":e.bytes2human(t)+" / "+(null===n.soft_percent||null===n.hard_percent?0:n.hard_percent)+"%";break;case"current_value":r=e.bytes2human(t);break;default:break}return r}},columns:function(){var e=[{name:"id",label:"#",field:"id",align:"left",style:"width: 2%"},{name:"path",label:this.$t("quota.path"),field:"path",align:"center",classes:"bg-grey-2 ellipsis",style:"max-width: 100px"},{name:"inodes",label:this.$t("quota.inodes"),align:"center"},{name:"length",label:this.$t("quota.length"),align:"center"},{name:"size",label:this.$t("quota.size"),align:"center"},{name:"realsize",label:this.$t("quota.realsize"),align:"center"},{name:"exceeded",label:this.$t("quota.exceeded"),field:"exceeded",align:"center"},{name:"expired_time",label:this.$t("quota.expired_time"),field:"expired_time",align:"center"},{name:"grace_period",label:this.$t("quota.grace_period"),field:"grace_period",align:"center"},{name:"operation",label:this.$t("operation"),field:"operation",align:"center"}];return e},multipleData:function(){var e=[{icon:"icon_dashboard",to:"/dashboard"},{label:this.$t("breadCrumbs.file_manager"),icon:"icon_file_manager",to:"/file_manager/smart_quota",call:this.refreshList},{label:this.$t("breadCrumbs.quota.page")}];return e},changeLoading:function(){return!(this.getquotaList.length>=0)},reqs:function(){return this.columns.reduce((function(e,t){return t.required&&e.push(t.name),e}),[])}}),methods:c(c(c({},Object(o["d"])(["SET_QUOTA_LIST","SET_SELECT_QUOTA_ROW"])),Object(o["b"])(["getQuotas","getDetailQuota","setQuota","deleteQuota"])),{onRowClick:function(e){this.selectRow=e,this.$store.commit("SET_SELECT_QUOTA_ROW",e)},onFilterData:function(e,t){return this.$refs.child.onFilter(e,t)},onFilter:function(e,t){var a=t?t.toLowerCase():"",n=this.byVisibility?p(p([],this.visibleColumns),this.reqs):this.filterCols,r=e.filter((function(e){return n.some((function(t){return(e[t]+"").toLowerCase().includes(a)}))}));return r},bytes2human:function(e){return Object(s["a"])(e)},refreshList:function(){return u(this,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return[4,this.$store.dispatch("getQuotas")];case 1:return e.sent(),[2]}}))}))},deleteQuota:function(){return u(this,void 0,void 0,(function(){var e;return d(this,(function(t){switch(t.label){case 0:return e={path:this.selectRow.path,soft_inodes:!0,hard_inodes:!0,soft_length:!0,hard_length:!0,soft_size:!0,hard_size:!0,soft_realsize:!0,hard_realsize:!0},[4,this.$store.dispatch("deleteQuota",e)];case 1:return t.sent(),[4,this.refreshList()];case 2:return t.sent(),[2]}}))}))}})},f=h,_=(a("0829"),a("2877")),m=a("9989"),b=a("eaac"),w=a("9c40"),q=a("bd08"),v=a("db86"),g=a("1c1c"),y=a("66e5"),k=a("4074"),x=a("4e73"),C=a("24e8"),$=a("f09f"),Q=a("a370"),O=a("4b7e"),z=a("7f67"),j=a("eebe"),D=a.n(j),L=Object(_["a"])(f,n,r,!1,null,null,null);t["default"]=L.exports;D()(L,"components",{QPage:m["a"],QTable:b["a"],QBtn:w["a"],QTr:q["a"],QTd:v["a"],QList:g["a"],QItem:y["a"],QItemSection:k["a"],QMenu:x["a"],QDialog:C["a"],QCard:$["a"],QCardSection:Q["a"],QCardActions:O["a"]}),D()(L,"directives",{ClosePopup:z["a"]})},"8ed5":function(e,t,a){}}]);